{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\Skaidrius\\\\Downloads\\\\ragemppro_dednet\\\\STATE-RAGE-UI-master-fixed\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Skaidrius\\\\Downloads\\\\ragemppro_dednet\\\\STATE-RAGE-UI-master-fixed\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\Skaidrius\\\\Downloads\\\\ragemppro_dednet\\\\STATE-RAGE-UI-master-fixed\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\Skaidrius\\\\Downloads\\\\ragemppro_dednet\\\\STATE-RAGE-UI-master-fixed\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Skaidrius\\\\Downloads\\\\ragemppro_dednet\\\\STATE-RAGE-UI-master-fixed\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import EventManager from\"../../EventManager\";import{HudContext}from'./context/HudContext';var Draggable=/*#__PURE__*/function(_React$Component){_inherits(Draggable,_React$Component);var _super=_createSuper(Draggable);function Draggable(props){var _this;_classCallCheck(this,Draggable);_this=_super.call(this,props);_this.state={id:_this.props.id,x:null,y:null};_this.dragStop=function(){var x=_this.state.x;var y=_this.state.y;try{mp.trigger('client:ui:saveHudDrag',_this.props.id,x,y);// eslint-disable-line\n}catch(e){}// mp.event на сохранение координат в БД\n};_this.setPos=function(_ref){var x=_ref.x,y=_ref.y;// this.setPos({ x: 10, y: 15 })\nvar element=_this.draggable.current;//element.style.position = 'absolute'\n//element.style.left = `${x}px`\n//element.style.top = `${y}px`\n_this.setState({x:x,y:y});};_this.onMouseDown=function(event){if(!_this.context.allowDraggable)return;if(event.button===2){_this.setPosToDefault(true);//this.dragStop()\nreturn;}if(event.button!==0)return;var element=_this.draggable.current;var shiftX=event.clientX-element.getBoundingClientRect().left;var shiftY=event.clientY-element.getBoundingClientRect().top;var oldZindex=element.style.zIndex;element.style.zIndex='9999';element.style.position='absolute';// document.body.append(element)\nvar that=_assertThisInitialized(_this);moveAt(event.clientX,event.clientY);function moveAt(clientX,clientY){that.setPos({x:clientX-shiftX,y:clientY-shiftY});}function onMouseMove(event){moveAt(event.clientX,event.clientY);}document.addEventListener('mousemove',onMouseMove);document.onmouseup=function(){//TODO\ndocument.removeEventListener('mousemove',onMouseMove);element.style.zIndex=oldZindex;element.onmouseup=null;that.dragStop();};};_this.onDragStart=function(){return false;};_this.setPosToDefault=function(){var byClick=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var element=_this.draggable.current;var x=element.offsetLeft;var y=element.offsetTop;if(_this.props.id==='car-speedbox'){x+=193;// Из-за zoom'a в CSS\n}else if(_this.props.id==='car-fuel'){x+=document.getElementById('car-elements').offsetWidth+2;}//element.style.margin = '0'\n//element.getElementsByTagName(\"DIV\")[0].style.margin = '0'\n//if (element.getElementsByTagName('DIV')[0].classList.contains('hide')) {\n//    y-=52\n//}\ntry{if(byClick)mp.trigger('client:ui:saveHudDefault',_this.props.id);// eslint-disable-line\n}catch(e){}/*if (this.props.id === 'car-speedbox') {\n            y-=52\n        }*/if(!window.HudComponents[_this.props.id]){window.HudComponents[_this.props.id]={x:x,y:y};}else{_this.setPos({x:window.HudComponents[_this.props.id].x,y:window.HudComponents[_this.props.id].y});return;}_this.setPos({x:x,y:y});};_this.draggable=React.createRef();return _this;}_createClass(Draggable,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.setPosToDefault();// Сюда вставить функционал приёма координат с серверной БД (использовать this.setPos)\n// this.setPos({ x: 0, y: 0 })\nEventManager.addHandler('hud-draggable-'+this.props.id,function(value){//mp.trigger('client:inventory:notify', `${value.id} | ${this.props.id}`); // eslint-disable-line\nif(value.id===_this2.props.id){try{//mp.trigger('client:inventory:notify', `${value.id} | ${value.x} | ${value.y}`); // eslint-disable-line\n_this2.setPos({x:value.x,y:value.y});}catch(e){//mp.trigger('client:inventory:notify', `${e}`); // eslint-disable-line\n}}else return;});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){EventManager.removeHandler('hud-draggable'+this.props.id);}// Вызывайте этот метод для изменения координат компонента\n},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{id:this.props.id,ref:this.draggable,className:this.props.className,onDragStart:this.onDragStart,onMouseDown:this.onMouseDown,style:this.props.style,onContextMenu:function onContextMenu(e){return e.preventDefault();}},this.props.children);}}]);return Draggable;}(React.Component);Draggable.contextType=HudContext;export{Draggable as default};","map":{"version":3,"sources":["C:/Users/Skaidrius/Downloads/ragemppro_dednet/STATE-RAGE-UI-master-fixed/src/components/hud/Draggable.jsx"],"names":["React","EventManager","HudContext","Draggable","props","state","id","x","y","dragStop","mp","trigger","e","setPos","element","draggable","current","setState","onMouseDown","event","context","allowDraggable","button","setPosToDefault","shiftX","clientX","getBoundingClientRect","left","shiftY","clientY","top","oldZindex","style","zIndex","position","that","moveAt","onMouseMove","document","addEventListener","onmouseup","removeEventListener","onDragStart","byClick","offsetLeft","offsetTop","getElementById","offsetWidth","window","HudComponents","createRef","addHandler","value","removeHandler","className","preventDefault","children","Component","contextType"],"mappings":"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","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport EventManager from \"../../EventManager\"\n\nimport {HudContext} from './context/HudContext'\n\nexport default class Draggable extends React.Component {\n\n    constructor(props) {\n        super(props)\n\n        this.draggable = React.createRef()\n    }\n\n    static contextType = HudContext\n\n    state = {\n        id: this.props.id,\n        x: null,\n        y: null\n    }\n\n    componentDidMount() {\n        this.setPosToDefault()\n\n        // Сюда вставить функционал приёма координат с серверной БД (использовать this.setPos)\n        // this.setPos({ x: 0, y: 0 })\n\n        EventManager.addHandler('hud-draggable-' + this.props.id, value => {\n            //mp.trigger('client:inventory:notify', `${value.id} | ${this.props.id}`); // eslint-disable-line\n            if (value.id === this.props.id) {\n                try {\n                    //mp.trigger('client:inventory:notify', `${value.id} | ${value.x} | ${value.y}`); // eslint-disable-line\n                    this.setPos({ x: value.x, y: value.y })\n                }\n                catch (e) {\n                    //mp.trigger('client:inventory:notify', `${e}`); // eslint-disable-line\n                }\n            } else return;\n        })\n    }\n\n    dragStop = () => {\n        const x = this.state.x\n        const y = this.state.y\n        try {\n            mp.trigger('client:ui:saveHudDrag', this.props.id, x, y); // eslint-disable-line\n        }\n        catch (e) {}\n        // mp.event на сохранение координат в БД\n    }\n\n    componentWillUnmount() {\n        EventManager.removeHandler('hud-draggable' + this.props.id);\n    }\n\n    // Вызывайте этот метод для изменения координат компонента\n    setPos = ({x, y}) => { // this.setPos({ x: 10, y: 15 })\n        let element = this.draggable.current\n\n        //element.style.position = 'absolute'\n        //element.style.left = `${x}px`\n        //element.style.top = `${y}px`\n\n        this.setState({ x, y })\n    }\n\n    onMouseDown = (event) => {\n        if (!this.context.allowDraggable) return\n\n        if (event.button === 2) {\n            this.setPosToDefault(true)\n            //this.dragStop()\n            return\n        }\n\n        if (event.button !== 0) return\n\n        let element = this.draggable.current\n\n        let shiftX = event.clientX - element.getBoundingClientRect().left\n        let shiftY = event.clientY - element.getBoundingClientRect().top\n\n        const oldZindex = element.style.zIndex\n        element.style.zIndex = '9999'\n        element.style.position = 'absolute'\n\n        // document.body.append(element)\n\n        let that = this\n\n        moveAt(event.clientX, event.clientY)\n\n        function moveAt(clientX, clientY) {\n            that.setPos({ x: (clientX - shiftX), y: (clientY - shiftY) })\n        }\n\n        function onMouseMove(event) {\n            moveAt(event.clientX, event.clientY)\n        }\n\n        document.addEventListener('mousemove', onMouseMove);\n\n        document.onmouseup = function() { //TODO\n            document.removeEventListener('mousemove', onMouseMove)\n            element.style.zIndex = oldZindex\n            element.onmouseup = null\n\n            that.dragStop()\n        }\n    }\n\n    onDragStart = () => {\n        return false\n    }\n\n    setPosToDefault = (byClick = false) => {\n        let element = this.draggable.current\n\n        let x = element.offsetLeft\n        let y = element.offsetTop\n\n        if (this.props.id === 'car-speedbox') {\n            x += 193 // Из-за zoom'a в CSS\n        } else if (this.props.id === 'car-fuel') {\n            x += document.getElementById('car-elements').offsetWidth+2\n        }\n\n        //element.style.margin = '0'\n        //element.getElementsByTagName(\"DIV\")[0].style.margin = '0'\n\n        //if (element.getElementsByTagName('DIV')[0].classList.contains('hide')) {\n        //    y-=52\n        //}\n\n        try {\n            if (byClick)\n                mp.trigger('client:ui:saveHudDefault', this.props.id); // eslint-disable-line\n        }\n        catch (e) {}\n\n        /*if (this.props.id === 'car-speedbox') {\n            y-=52\n        }*/\n\n        if (!window.HudComponents[this.props.id]) {\n            window.HudComponents[this.props.id] = { x, y }\n        } else {\n            this.setPos({ x: window.HudComponents[this.props.id].x, y: window.HudComponents[this.props.id].y })\n            return\n        }\n\n        this.setPos({ x, y })\n    }\n    \n    render() {\n        return (\n            <div\n                id={this.props.id}\n                ref={this.draggable}\n                className={this.props.className}\n                onDragStart={this.onDragStart}\n                onMouseDown={this.onMouseDown}\n                style={this.props.style}\n                onContextMenu={(e) => e.preventDefault()}\n            >\n                {this.props.children}\n            </div>\n        )\n    }\n}\n\nDraggable.propTypes = {\n    id: PropTypes.string,\n    style: PropTypes.object,\n    className: PropTypes.string,\n    children: PropTypes.node\n}"]},"metadata":{},"sourceType":"module"}